<html>
<head>
<title>Daynight Map and Clock</title>
<script src = "vector.js"></script>
<script src = "vectorutils.js"></script>
<script src = "map.js"></script>
<script src = "sun.js"></script>
<script src = "ne_110m_land.json"></script>
</head>
<body>

<svg width="1000" height="1000" id = "mainplot">

</svg>

<script>
var map = new Map("mainplot")
var sun = new Sun(new Date(Date.now()))

for (var i = 0; i < lands.features.length; i++) {
	map.plotGeometry(lands.features[i].geometry.coordinates[0])
}

function updateSun() {
	let sunDate = sun.date
	sunDate = new Date(sunDate.getTime() + 24*60*60000)
	sun.setDate(sunDate)
	map.setMarker(sun.longitude, sun.latitude, "#FFFF00", "sun")
	shadowGeometry = Shadow.getShadowPolygon(sun, map)
	map.plotXYGeometry(shadowGeometry, color = "#000000", opacity = "50%", "shadow")
}

updateSun()
setInterval(updateSun, 1000)

navigator.geolocation.getCurrentPosition((position) => {
	let longitudeR = VectorUtils.degreeToRadian(position.coords.longitude)
	let latitudeR = VectorUtils.degreeToRadian(position.coords.latitude)
	map.setMarker(longitudeR, latitudeR, "#FF0000", "user")
	map.setRotate(position.coords.longitude)
});

</script>

</body>
</html>